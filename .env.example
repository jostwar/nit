## Backend
DATABASE_URL=postgresql://nitiq:nitiq@localhost:5432/nitiq?schema=public
JWT_SECRET=change-me
JWT_REFRESH_SECRET=change-me
JWT_ACCESS_TTL=1h
JWT_REFRESH_TTL=7d
PORT=4000
# Origen(es) CORS para la API (varios separados por coma). Vacío = permitir todos. En producción usa la URL del front (ej. http://TU_IP:3000 o https://tu-dominio.com).
CORS_ORIGIN=http://localhost:3000
TENANT_NAME=NITIQ Demo

# Copilot BI (OpenAI). Si no se define, el copilot usa lógica interna sin LLM.
OPENAI_API_KEY=

# Source API (opcional)
SOURCE_API_URL=
SOURCE_API_TOKEN=
SOURCE_API_PROVIDER=
SOURCE_API_DB=
SOURCE_API_VENDOR=
SOURCE_API_CXC_BASE_URL=https://cartera.fomplus.com
SOURCE_API_VENTAS_BASE_URL=https://gspapiest.fomplus.com
SOURCE_SYNC_ENABLED=true
# Cupo del cliente: si la API de cartera (EstadoDeCuentaCartera) devuelve cupo/cupocredito/credito, se guarda en Cartera. Campos probados: cupo,cupocredito,credito,creditlimit,cupo_credito,limite.

# Inventario (marcas): GenerarInformacionInventariosGet; cruce referencia venta → marca
SOURCE_API_INVENTARIO_BASE_URL=https://gspapi.fomplus.com
SOURCE_API_INVENTARIO_TOKEN=
# Si no se define SOURCE_API_INVENTARIO_TOKEN, se usa SOURCE_API_TOKEN. SOURCE_API_DB también aplica.
# Campo de marca en inventario (por defecto MARCA)
# SOURCE_INVENTARIO_BRAND_FIELDS=MARCA,marca
# Campo de clase en inventario (código; el nombre se carga con PUT /source/class-mapping)
# SOURCE_INVENTARIO_CLASS_FIELDS=CLASE,clase,codclase
# Días por chunk al pedir ventas al ERP (7 por defecto). Con 31 hay menos llamadas en carga histórica.
# SOURCE_VENTAS_CHUNK_DAYS=31
# Campos de ciudad/sector en GenerarInfoVentas (por defecto incluye NOMSEC, nomciu, ciudad, etc.)
# SOURCE_VENTAS_CITY_FIELDS=NOMSEC,nomciu,ciudad,cli_nomciu
# TIPMOV / TIPOMOV (GenerarInfoVentas): define SUMA vs RESTA para ventas netas. La API suele enviar TIPMOV.
# Tabla de referencia:
#   Código | Concepto                         | Definición
#   ------|----------------------------------|----------
#   01    | Factura de venta                  | SUMA
#   13    | Factura de caja                   | SUMA
#   04    | Nota crédito a factura            | RESTA
#   06    | Nota crédito independiente        | RESTA
#   15    | Devolución independiente caja    | RESTA
# Campo(s) en la API para el tipo de movimiento. No incluir TIPDOC (puede mezclar con 05/Otro); solo TIPMOV/TIPOMOV.
# SOURCE_VENTAS_TIPOMOV_FIELDS=TIPMOV,TIPOMOV,tipmov,tipomov
# Códigos que RESTAN venta. Por defecto 04,06,15. Ventas netas = facturas SUMA − facturas RESTA.
# SOURCE_VENTAS_TIPOMOV_RESTA=04,06,15
# Marca y clase en ítems de venta (REFER = referencia en GenerarInfoVentas):
# 1) Que GenerarInfoVentas envíe MARCA y CLASE en cada línea (SOURCE_VENTAS_BRAND_FIELDS / SOURCE_VENTAS_CLASS_FIELDS).
# 2) API de inventario (arriba): cruce REFER con GenerarInformacionInventariosGet.
# 3) Directorio en BD: cargar REFER→MARCA,CLASE con PUT /api/source/inventory-directory; el sync cruza por REFER.
# Opcional: load-mappings (brand-mapping.json, class-mapping.json) para código→nombre. Luego sincronizar.
# Campo(s) de marca en GenerarInfoVentas (por defecto MARCA,nommar,nommarca,marca,brand,codmar).
# SOURCE_VENTAS_BRAND_FIELDS=MARCA,marca,codmar
# Campo(s) de clase en GenerarInfoVentas (por defecto CLASE,clase,codclase,class,codcla).
# SOURCE_VENTAS_CLASS_FIELDS=CLASE,clase,codclase
# Opcional CSV ref→marca / ref→clase (si no usas inventario ni campos en ventas): scripts/ref-brand-mapping.csv y ref-class-mapping.csv.
# SOURCE_REF_BRAND_CSV_PATH=scripts/ref-brand-mapping.csv
# SOURCE_REF_CLASS_CSV_PATH=scripts/ref-class-mapping.csv
# Optimización de sincronización (opcionales):
# SOURCE_API_TIMEOUT_MS=90000
# SOURCE_VENTAS_RANGE_CONCURRENCY=2
# SYNC_INVOICE_CONCURRENCY=8
# SYNC_PAYMENT_CONCURRENCY=4
# SYNC_CHUNK_CONCURRENCY=2

## Frontend (en producción debe ser la URL pública de la API, ej. http://IP:4000/api)
# URL de la API que el navegador usará. En producción (Lightsail): si accedes por IP:3000, usa http://TU_IP:4000/api; si Nginx sirve web y /api en el mismo host, deja vacío o usa https://tu-dominio.com/api
NEXT_PUBLIC_API_URL=http://localhost:4000/api
